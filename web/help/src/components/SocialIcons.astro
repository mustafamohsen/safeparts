---
import config from 'virtual:starlight/user-config';
import { Icon } from '@astrojs/starlight/components';

const links = config.social || [];

const baseUrl = (import.meta.env.BASE_URL ?? '/').endsWith('/')
	? import.meta.env.BASE_URL ?? '/'
	: `${import.meta.env.BASE_URL ?? '/'}/`;

const logoSrc = `${baseUrl}logo.svg`;

const appLink = {
	label: 'Open app',
	href: '/',
};
---

{
	(links.length > 0 || appLink) && (
		<>
			<a
				href={appLink.href}
				target="_blank"
				rel="noopener noreferrer"
				class="sl-flex app-link"
				aria-label={appLink.label}
				title={appLink.label}
			>
				<img src={logoSrc} alt="" class="app-mark" width="18" height="18" />
				<span class="app-text">App</span>
			</a>
			{links.map(({ label, href, icon }) => (
				<a
					href={href}
					target="_blank"
					rel="me noopener noreferrer"
					class="sl-flex"
					aria-label={label}
					title={label}
				>
					<span class="sr-only">{label}</span>
					<Icon name={icon} />
				</a>
			))}
		</>
	)
}

<style>
	@layer starlight.core {
		a {
			color: var(--sl-color-text-accent);
			padding: 0.5em;
			margin: -0.5em;
		}
		a:hover {
			opacity: 0.8;
		}

		/* Slightly more visible than plain icons, but still minimal. */
		.app-link {
			color: var(--sl-color-text);
			gap: 0.5rem;
			padding: 0.35rem 0.55rem;
			margin: 0;
			border-radius: 999px;
			border: 1px solid var(--sl-color-hairline);
			background: hsl(0 0% 0% / 0.28);
		}
		.app-link:hover {
			color: var(--sl-color-text-accent);
			background: hsl(0 0% 100% / 0.06);
		}

		.app-text {
			font-size: var(--sl-text-xs);
			font-weight: 600;
			letter-spacing: 0.02em;
		}

		.app-mark {
			display: block;
			filter: drop-shadow(0 6px 10px rgba(0, 0, 0, 0.25));
		}
	}
</style>
